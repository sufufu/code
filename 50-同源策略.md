### 同源策略

ajax 受同源策略的约束

同源策略：为了保证浏览器的信息安全，当前源中的信息只能在当前的源中使用；其他源如果想使用当前源中的信息，需要做特殊的处理；

同源策略要求通信的源的协议、域名、端口号相同，如果三者中有一个不同就是非同源。非同源的通信叫做跨域，需要做特殊的处理；

### 常用的跨域解决方案

1. jsonp
2. 服务端转发；只有客户端受同源策略的约束，服务端是不受约束的；请求咱们自己的接口，然后让服务端在服务器上去请求第三方的接口，拿到第三方接口的数据返回给我们；
3. nginx 转发， nginx 是服务端应用程序，在服务器可以配置某种规则，nginx 就会帮我们转发请求到第三方；（需要服务端和运维的支持）
4. AJAX 虽然好用，但是不能跨域；如果一定要跨域就需要做特殊处理

### jsonp

```javascript
// jsonp: 一种跨域技术（和 json 没有直接关系）

// 要从如下接口获取数据：
// http://matchweb.sports.qq.com/kbs/calendar?columnId=100000

// JSONP 的原理：利用了 script 标签的 src 属性不受同源策略的约束（link 的 href 和 img 的 src 都不受约束）；所以我们用 script 的 src 请求第三方的接口，但是需要做一点特殊的处理；

// 1. 首先在页面中写一个 script 标签，src 属性值是第三方的接口；
// 2. 声明一个函数 fn，fn 要有一个形参，把使用第三方数据的操作都写在 fn 里面；
function fn(data) {
  console.log(data);
}
// 3. 给前面的 script 的 src 上的接口多拼接一个 callback=fn 的参数;
// 4. 如果第三方的接口支持 jsonp，会返回一个形如fn({xxxxx})的东西；script 是用来加载 js 代码的，script 就认为 fn({xxx}) 是 js 代码，浏览器就会执行它；而 fn() 就是让 fn 这个函数执行，小括号里面的东西就成为执行 fn 时的实参；

// JSONP 只能用来发 GET 请求；
// callback 不是死的，而是第三方接口定义好的，如果使用时要查阅第三方的文档；
```